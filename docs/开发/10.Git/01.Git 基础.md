---
title: Git 基础
date: 2022-01-24 23:06:54
permalink: /pages/7b9a0f/
categories:
  - 开发
  - Git
tags:
  - 
---

> 摘抄自 [Pro Git](https://gitee.com/progit/)

## 1. Git 的特点

Git 在保存和处理各种信息的时候，虽然操作起来的命令形式非常相近，但它与其他版本控制系统的做法颇为不同，因此不要尝试把各种概念和其他版本控制系统相比拟，但理解这些差异将有助于你准确地使用 Git 提供的各种工具。

#### 1）直接记录快照，而非差异比较

Git 和其他版本控制系统的主要差别在于，Git 只关心**文件的整体**是否发生变化，而大多数其他系统则只关心文件内容的具体差异。Git 并**不保存这些前后变化的差异数据**。实际上，Git 更像是把变化的文件**作快照**后，记录在一个微型的文件系统中。每次提交更新时，它会纵览一遍所有文件的指纹信息并对文件作一快照，然后保存一个指向这次快照的索引。为提高性能，若文件没有变化，Git 不会再次保存，而只对上次保存的快照作一链接。

#### 2）近乎所有操作都是本地执行

Git 在本地磁盘上就保存着所有当前项目的历史更新，所以处理起来速度飞快。

#### 3）时刻保持数据完整性

在保存到 Git 之前，所有数据都要进行**内容的校验和**（checksum）计算，并将此结果**作为数据的唯一标识和索引**。这项特性作为 Git 的设计哲学，建在整体架构的最底层。所以如果文件在传输时变得不完整，或者磁盘损坏导致文件数据缺失，Git 都能立即察觉。

Git 使用 **SHA-1 算法**计算数据的校验和，通过对文件的内容或目录的结构计算出一个 SHA-1 哈希值，作为指纹字符串。该字串由 40 个十六进制字符（0-9 及 a-f）组成，看起来就像是：

```
24b9da6552252987aa493b52f8696cd6d3b00373
```

Git 的工作完全依赖于这类指纹字串，所以你会经常看到这样的哈希值。实际上，所有保存在 Git 数据库中的东西都是用此哈希值来作索引的，而不是靠文件名。

#### 4）多数操作仅添加数据

在 Git 里，一旦提交快照之后就完全不用担心丢失数据，这种**高可靠性**令我们的开发工作安心不少，尽管去做各种试验性的尝试好了，**再怎样也不会弄丢数据**。

#### 5）文件的三种状态

<u>对于任何一个文件，在 Git 内都只有三种状态：已提交（committed），已修改（modified）和已暂存（staged）</u>。

+ **已提交**表示该文件已经被安全地保存在本地数据库中了；
+ **已修改**表示修改了某个文件，但还没有提交保存；
+ **已暂存**表示把已修改的文件放在下次提交时要保存的清单中。

由此我们看到 Git 管理项目时，<u>文件流转的三个工作区域：Git 的工作目录，暂存区域，以及本地仓库</u>：

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20220124232643499.png" alt="image-20220124232643499" style="zoom: 80%;" />

+ **Git 目录**（`.git`）是保存元数据和对象数据库的地方。该目录非常重要，每次克隆镜像仓库的时候，实际拷贝的就是这个目录里面的数据。
+ 从项目中取出某个版本的所有文件和目录，用以开始后续工作的叫做**工作目录**；
+ 所谓的暂存区域只不过是个简单的文件，一般都放在 Git 目录中。有时候人们会把这个文件叫做索引文件，不过标准说法还是叫**暂存区域**；

我们可以从文件所处的位置来判断状态：如果是 Git 目录中保存着的特定版本文件，就属于已提交状态；如果作了修改并已放入暂存区域，就属于已暂存状态；如果自上次取出后，作了修改但还没有放到暂存区域，就是已修改状态。

## 2. Git 的配置

**git config** 专门用来配置或读取相应的**工作环境变量**。而正是由这些环境变量，决定了 Git 在各个环节的具体工作方式和行为。这些变量可以存放在以下三个不同的地方：

+ `/etc/gitconfig` 文件：系统中**对所有用户**都普遍适用的配置。若使用 `git config` 时用 `--system` 选项，读写的就是这个文件。
+ `~/.gitconfig` 文件：用户目录下的配置文件只适用于**该用户**。若使用 `git config` 时用 `--global` 选项，读写的就是这个文件。
+ 当前项目的 git 目录中的配置文件（也就是工作目录中的 `.git/config` 文件）：这里的配置仅仅针**对当前项目**有效。每一个级别的配置都会覆盖上层的相同配置，所以 `.git/config` 里的配置会覆盖 `/etc/gitconfig` 中的同名变量。

在 Windows 系统上，Git 会找寻用户主目录下的 `.gitconfig` 文件。主目录即 `$HOME` 变量指定的目录，一般都是 `C:\Documents and Settings\$USER`。此外，Git 还会尝试找寻 `/etc/gitconfig` 文件，只不过看当初 Git 装在什么目录，就以此作为根目录来定位。

### 2.1 用户信息

配置 user.name 和 user.email，每次 Git 提交时都会引用这两条信息，**说明是谁提交了更新**，所以会随更新内容一起被永久纳入历史记录：

```bash
$ git config --global user.name "John Doe"
$ git config --global user.email johndoe@example.com
```

+ 如果用了 `--global` 选项，那么更改的配置文件就是位于你用户主目录下的那个，以后你所有的项目都会默认使用这里配置的用户信息。

### 2.2 查看配置信息

`git config --list` 命令检查已有的配置信息：

```shell
$ git config --list
    user.name=Scott Chacon
    user.email=schacon@gmail.com
    color.status=auto
    color.branch=auto
    color.interactive=auto
    color.diff=auto
    ...
```

+ 有时候会看到重复的变量名，那就说明它们来自不同的配置文件（比如 `/etc/gitconfig` 和 `~/.gitconfig`），不过最终 Git 实际采用的是最后一个。

也可以直接查阅某个环境变量的设定，只要把特定的名字跟在后面即可，像这样：

```shell
$ git config user.name
    Scott Chacon
```

