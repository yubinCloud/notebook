---
title: 基础入门
date: 2023-01-07 16:51:00
permalink: /pages/security/xd/day7-10
categories:
  - 安全
  - 网络安全
  - 小迪安全学习笔记
tags:
  - 
---

## Day 7：CDN 相关技术

<mark>CDN</mark> 的全称是 Content Delivery Network，即内容分发网络。CDN是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，**使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率**。但在安全测试过程中，若目标存在 CDN 服务，将会影响到后续的安全测试过程。

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20230107170956252.png" alt="image-20230107170956252" style="zoom:80%;" />

+ 由于 CDN 的存在，你在渗透网站或漏洞利用时，可能针对的只是一个缓存而不是真实目标，因此给我们造成困难。

### 7.1 如何判断目标存在 CDN 服务？

super-ping，如果各地都有不同的响应 IP，那它就是用了 CDN 服务。

或者使用 nslookup 域名，看看是否会有很多节点：

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20230107172903881.png" alt="image-20230107172903881" style="zoom: 80%;" />

也可以看响应时间，工具：http://tool.chinaz.com/speedtest。

### 7.2 常见的 CDN 绕过技术

1. 子域名查询：有的网站主域名（访问量大的网站）会做 CDN，但是子域名可能不会做

```
xiaodi8.com       192.168.1.100
www.xiaodi8.com   192.168.1.100
bbs.xiaodi8.com   192.168.1.100 或 1.1-254 或不在同网段
```

2. 邮件服务查询：我们访问别人，可能通过 CDN，但别人访问我们通常不会走 CDN。而且邮箱服务器往往内部人使用，这没必要用 CDN。
3. 国外地址请求：国内公司的客户往往是国内的，因为很可能国外没有 CDN 的节点，这时可能就直接走 IP 了。
4. 遗留文件：这是一个没办法的办法…
5. 黑暗引擎搜索特定文件，比如 https://fofa.info/
6. DNS 历史记录，以量打量：CDN 节点是有流量上限的，用光之后就会直通原机，这也是一种流量攻击（这种方法不太推荐，有点邢）

### 7.3 演示案例

子域名上面的小技巧：

+ 二级域名和三级域名查到的结果可能不一样
+ 主域名和子域名查询到的可能不一样，甚至 www.xiaodi8.com 可能加上 CDN，但 xiaodi8.com 却可能不加。
+ DNS 历史记录
+ 第三方接口(接口查询)
+ 采集 / 国外请求
+ 黑暗引擎（shodan 搜指定 hash 文件）
+ 本地清下 DNS，然后 hosts 里写上得到的 ip 和域名，如果是 CDN 可能会出现刷新异常，如果打开很快大概率是原机

## Day 8：架构，搭建，WAF 等

