---
title: 朴素贝叶斯法
date: 2022-07-29 14:42:08
permalink: /pages/ml/statistical-learning-method/naive-Bayes/
categories:
  - AI
  - 机器学习
  - 李航-统计学习方法
tags:
  - 
---

贝叶斯思维和我们人类做判断的思路是相似的，都是按照**「主观判断」**、**「添加新信息」**、**「最终结论」**三步骤进行，换成数学思维里就是**「先验概率」**、**「调整因子」**、**「后验概率」**。

> 比如今天是冬至，你走到餐馆里，老板根据今天的节气做出一个主观判断，会问你“要不要来盘饺子”，因为大多数人在冬至这一天会选择吃饺子。但如果你用宝儿姐的四川话回一句“我今天不吃饺子”，那这句话其实相当于在原有的基础上提供了新的信息，老板根据新提供的信息可能会判断出你是个四川人，于是会问你“要不要来碗羊汤”，因为四川人在冬至这一天会选择喝羊汤。如果你说好，那就是老板成功预测出今天你打算喝羊汤这个最终结论。

上面例子的整个过程用 Bayes 思维表述就是：

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20220729145509166.png" alt="image-20220729145509166" style="zoom:80%;" /></center>

## 1. 朴素贝叶斯定理

### 1.1 Bayes 定理

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20220729150934386.png" alt="image-20220729150934386" style="zoom:80%;" /></center>

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20220729151020298.png" alt="image-20220729151020298" style="zoom:90%;" /></center>

### 1.2 Bayes 分类

存在 K 类：$c_1,c_2,\dots,c_K$，给定一个新的实例 $x=(x^{(1)},x^{(2)},\dots,x^{(n)})$，问：该实例归属于哪一类？

由 Bayes 公式知 $P(Y=c_i|X=x) = \frac{P(X=x|Y=c_i) \cdot P(Y=c_i)}{\sum^K_{i=1}P(X=x|Y=c_i) \cdot P(Y=c_i)}$，所以我们可以分别计算 $P(Y=c_1|X=x), P(Y=c_2|X=x), \dots, P(Y=c_K|X=x)$ 的值，然后找到最大的那一个，从而就可以确定归属的类了。

公式也可以写成：

$$\arg\max_{c_i} P(X=x|Y=c_i)\cdot P(Y=c_i)$$

那么什么是朴素 Bayes 呢？

### 1.3 Naive Bayes 

朴素贝叶斯和贝叶斯相比，做了一个“朴素”的假设：**特征与特征之间是相互独立、互不影响的**。

这样我们回到 Bayes 分类的 $$\arg\max_{c_i} P(X=x|Y=c_i)\cdot P(Y=c_i)$$ 公式中，因为所有的 $x^{(i)}$ 与 $x^{(j)}$ 在 $i \neq j$ 时相互独立，那么 $P(X=x|Y=c_i)$ 就可以写成：

$$P(X=x|Y=c_i) = \prod^n_{j=1}P(X^{(j)}=x^{(j)}|Y=c_i)$$

所以最终只需要求出：

$$\arg\max_{c_i}P(Y=c_i) \prod^n_{j=1}P(X^{(j)}=x^{(j)}|Y=c_i)$$

从而找到了归属的类别，完成了朴素贝叶斯法的分类。

## 2. 朴素贝叶斯法

