---
title: ELMo
date: 2022-12-20 19:27:00
permalink: /pages/lhy/anomaly-detection/
categories:
  - AI
  - 深度学习
  - 李宏毅-2019版
tags:
  - 
---

## 1. Background

### 1.1 Problem Formulation

+ Given a set of training data $\{ x^1, x^2, \dots, x^N \}$
  + 用上标来表示一个完整的 data point，用下标来表示一个完整东西的其中一部分
+ We want to find a function detecting input $x$ is **similar** to training data or not.

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220193207976.png" alt="image-20221220193207976" style="zoom:80%;" /></center>

<u>Different approaches use different ways to determine the similarity</u>. 我们这里的 anomaly 不一定就说是坏的，它可能是 outlier、novelty 等。

### 1.2 What is Anomaly?

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220193549294.png" alt="image-20221220193549294" style="zoom:80%;" />

### 1.3 Applications

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220193929848.png" alt="image-20221220193929848" style="zoom: 80%;" />

### 1.4 Binary Classification？

一个很直觉的方法就是用 Binary Classification 来做：

+ Given normal data $\{ x^1, x^2, \dots, x^N \}$  => *Class 1*
+ Given anomaly $\{ \tilde{x}^1, \tilde{x}^2, \dots, \tilde{x}^N \}$  => *Class 2*
+ Then training a binary classifier ….

但这样做的问题是，如下图，Pokemon 的资料是差不多的，但是 NOT Pokemon 的东西太多了，你根部无法得知 Class 2 的 distribution 长什么样子。

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220194444198.png" alt="image-20221220194444198" style="zoom:75%;" />

还有一个原因是，其实你不太容易收集到 anomal examples，比如欺诈检测，银行收集到的大部分资料都是正常的交易。

### 1.5 Categories

根据所拥有的资料的样子，可以做如下分类：

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220195238030.png" alt="image-20221220195238030" style="zoom:80%;" /></center>

+ 如果你希望你的模型在看到不知道的数据类别时，能够 output 一个 “unknown”，那么这种问题也称为 **Open-set Recognition**。

## 3. Case 1：With Classifier

### 3.1 Example Application

任务：From The Simpsons or not

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220195834309.png" alt="image-20221220195834309" style="zoom:67%;" />

我们收集的资料每个 Simpsons 家族人物的 image 都还有一个 label：

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220195938014.png" alt="image-20221220195938014" style="zoom:75%;" />

有一个人就是这么干的，收集了一大堆 Simpsons 家族人物的训练资料来训练一个 classifier，结果如下（还不错）：

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220200126868.png" alt="image-20221220200126868" style="zoom: 95%;" />

### 3.2 How to use the Classifier?

我们想要做的事情就是根据这个 classifier 来帮我们判断一个 image 是否来自于 Simpsons 家族人物：

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220200348245.png" alt="image-20221220200348245" style="zoom: 80%;" />

+ 我们不仅让这个 classifier 告诉我们它属于 Simpsons 家族的哪个人物，还要它告诉我们这次判断的 confidence score $c$，然后比对 confidence score 和 threshold $\lambda$ 来确定是否 normal。

### 3.3 How to estimate Confidence?

我们知道 classifier 输出的其实是一个 distribution，然后机器的 confidence 就是 the maximum scores：

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220200915787.png" alt="image-20221220200915787" style="zoom: 80%;" /></center>

当然还有其他的计算 confidence 的方法，比如计算 negative entropy。

做了一些实验，实验结果如下，效果还行：

<img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/image-20221220201413172.png" alt="image-20221220201413172" style="zoom:75%;" />

当然也有是一些识别错误的。

// TODO