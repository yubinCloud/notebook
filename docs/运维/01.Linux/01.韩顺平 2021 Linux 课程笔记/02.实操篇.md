---
title: 实操篇
date: 2022-02-07 19:05:42
permalink: /pages/02c9a7/
categories:
  - 运维
  - Linux
  - 韩顺平 2021 Linux 课程笔记
tags:
  - 
---

## 1. 开机、重启与用户登录注销

### 1.1 关机 & 重启命令

|             命令             | 说明                      |
| :--------------------------: | ------------------------- |
|       shutdown -h now        | 立刻进行关机              |
|        shutdown -h 2         | “hello，2 分钟后会关机了” |
| `shutdown -r now` = `reboot` | 现在重启                  |
|             halt             | 关机，与上面一样          |
|             sync             | 把内存的数据同步到磁盘    |

+ **不管是重启还是关机，首先要运行 sync 命令**，把内存中的数据写到磁盘中。目前的 shutdown/reboot/halt 等命令均在关机前进行了 sync，但小心驶得万年船。
+ root 才可以关机。

### 1.2 用户登录和注销

**登录**时尽量少用 root 账号，避免操作失误。使用 `su <用户名>` 可以切换身份。

`logout` 命令即可**注销**用户。这个指令再图形运行级别无效。

## 2. 用户管理

Linux 是一个**多用户多任务**的操作系统。

### 2.1 添加用户

语法：`useradd 用户名`

+ 当用户创建成功后，会**自动创建与用户同名的家目录**。
+ 也可以通过 `useradd -d 指定目录 用户名` 来给新用户指定家目录。

### 2.2 指定/修改密码

`passwd tom`：给 tom 指定密码

### 2.3 删除用户

+ `userdel yubin`：删除用户 yubin，但要保留家目录
+ `userdel -r yubin`：删除用户及其家目录

一般情况下，我们**建议保留**，毕竟他所做的工作放在了里面。

 ### 2.4 查询用户信息

`id 用户名`：查询该用户的信息，当用户不存在时返回无此用户。

### 2.5 切换用户

当操作权限不够时，可以通过 `su` 命令切换到高权限用户。

+ 从高权限到低权限的切换不需要密码，反之需要。
+ 当需要返回到原来用户时，使用 exit/logout 指令。

### 2.6 查看当前登录用户

`whoami` = `who am I`：显示第一次登录时的用户。

### 2.7 用户组

用户组可以让系统对有共性/权限的多个用户进行统一管理。

+ `groupadd 组名`：新增组
+ `groupdel 组名`：删除组

如何将让一个用户加入一个组呢？有以下几种方法：

1. 增加用户时直接加上组：`useradd -g 用户组 用户名`
2. 修改用户的组：`usermod -g 用户组 用户名`
3. 若一个用户没有指定加入哪个组，会**默认在一个与自己同名的组**中

  ### 2.8 用户和组相关的文件

+ **/etc/passwd** 文件：用户的配置文件，记录用户的各种信息
  + 每行的含义：`用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录shell`
+ **/etc/shadow** 文件：口令的配置文件
  + 每行的含义：`登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志`
+ **/etc/group** 文件：组的配置文件，记录各组的信息
  + 每行的含义：`组名:口令:组标识号:组内的用户列表`

## 3. 实用指令

### 3.1 运行级别

|    运行级别    | 说明                                   |
| :------------: | -------------------------------------- |
|       0        | 关机                                   |
|       1        | 单用户模式（可以帮助我们找回丢失密码） |
|       2        | 多用户状态没有网络服务                 |
| <mark>3</mark> | 多用户状态**有网络服务**【工作中常用】 |
|       4        | 系统未使用，保留给用户                 |
| <mark>5</mark> | **图形界面**                           |
|       6        | 系统重启                               |

+ 常见运行级别是 3 和 5，也可以指定默认运行级别。

`init <num>`：切换到 num 运行级别，如 `init 3` 将切换到多用户状态有网络服务模式。

#### CentOS 7 后运行级别说明

+ **multi-user.target**：相当于 runlevel 3
+ **graphical.target**：相当于 runlevel 5

查看当前默认运行级别：`systemctl get-default`

设置默认运行级别：`systemctl set-default TARGET.target`

> 当我们在图形化下将默认运行级别设为 graphical.target 后，重启系统后会默认进入黑框框界面，即 runlevel 3。

### 3.2 找回 root 密码

// TODO

### 3.3 帮助指令

+ `man [命令或配置文件]`：获得帮助信息，比如 `man ls`
+ `help 命令`：获得 shell 内置命令的帮助信息

如果英语不太好，**百度更直接**。



